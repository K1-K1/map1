<html>
  <head>
      <link rel="stylesheet" href="css/map.css" type="text/css">
      <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
      <script type="text/javascript" src="http://openlayers.org/api/OpenLayers.js"></script>
      <script type="text/javascript" src="js/jspdf.min.js"></script>
      <script type="text/javascript" src="js/downloadify.min.js"></script>
      <script type="text/javascript" src="js/swfobject.js"></script>
      <script type="text/javascript" src="js/mappdf.js"></script>    
  </head>      
  <body style="margin: 0; padding: 0;">
    <div id="downloadify" class="panel">
	<img src="image/loader.gif" />	
    </div>
    <script>
	var urlParams = {};
	    (function () {
		var match,
		    pl     = /\+/g,  // Regex for replacing addition symbol with a space
		    search = /([^&=]+)=?([^&]*)/g,
		    decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
		    query  = window.location.search.substring(1);

		while (match = search.exec(query))
		   urlParams[decode(match[1])] = decode(match[2]);
	})();

	
	var M = parseFloat(urlParams['M'])
	var ll0 = [parseFloat(urlParams['x1']),parseFloat(urlParams['y1'])]
	var ll1 = [parseFloat(urlParams['x2']),parseFloat(urlParams['y2'])]
	var marginX = parseFloat(urlParams['marginX'])
	var marginY = parseFloat(urlParams['marginY'])
	var minDPI = parseFloat(urlParams['minDPI']);
	var orientation = urlParams['o']
	var format = urlParams['f']		
	
	mapPdf = new MapPdf(opener !== null ? opener.map : undefined);	
	mapPdf.render(M,ll0,ll1,'downloadify',marginX,marginY,minDPI,orientation,format)
    </script>
    <div id="vector_layer"></div>
  </body>
</html>

